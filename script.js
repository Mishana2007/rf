document.addEventListener("DOMContentLoaded", function () {
    const menuButton = document.querySelector(".menu-btn"); // –ò–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ —Ç–≤–æ–π –∫–ª–∞—Å—Å
    const closeMenuButton = document.getElementById("close-menu");
    const overlay = document.getElementById("overlay");
    const mobileMenu = document.getElementById("mobile-menu");

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Å–æ–±—ã—Ç–∏–π
    if (menuButton && closeMenuButton && overlay && mobileMenu) {
        // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é
        function openMenu() {
            mobileMenu.classList.add("active");
            overlay.classList.add("active");
        }

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é
        function closeMenu() {
            mobileMenu.classList.remove("active");
            overlay.classList.remove("active");
        }

        // –ù–∞–∑–Ω–∞—á–∞–µ–º —Å–æ–±—ã—Ç–∏—è
        menuButton.addEventListener("click", openMenu); // –¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ .menu-btn
        closeMenuButton.addEventListener("click", closeMenu);
        overlay.addEventListener("click", closeMenu);
    } else {
        console.error("‚ùå –û—à–∏–±–∫–∞: –û–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–µ–Ω—é –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ DOM.");
    }
});

// document.addEventListener("DOMContentLoaded", function () {
//     const rentButtons = document.querySelectorAll(".btn-rent");

//     rentButtons.forEach(button => {
//         button.addEventListener("click", function (event) {
//             event.preventDefault();
//             alert("–§—É–Ω–∫—Ü–∏—è –∞—Ä–µ–Ω–¥—ã –ø–æ–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º!");
//         });
//     });
// });

document.addEventListener("DOMContentLoaded", function () {
    const rentButtons = document.querySelectorAll(".btn-rent");
    const modal = document.getElementById("booking-popup");
    const overlay = document.getElementById("popup-overlay");
    const closeModal = document.getElementById("booking-close");
    const submitBtn = document.getElementById("submit-btn");
    const policyCheckbox = document.getElementById("policy");
    const bookingForm = document.getElementById("booking-form");
    const boatImage = document.getElementById("booking-boat-img");
    const boatName = document.getElementById("booking-boat-name");

    // –î–ê–ù–ù–´–ï –¢–ï–õ–ï–ì–†–ê–ú-–ë–û–¢–ê
    const TELEGRAM_BOT_TOKEN = "7873850845:AAHqXxX-jyozeUKTxSaGPqMmo9uIetwTyss";  // –í—Å—Ç–∞–≤—å —Å—é–¥–∞ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
    const TELEGRAM_CHAT_ID = "301593280"; // –í—Å—Ç–∞–≤—å —Å—é–¥–∞ ID –∫–∞–Ω–∞–ª–∞ (—Å -100 –≤ –Ω–∞—á–∞–ª–µ, –µ—Å–ª–∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π)

    // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    rentButtons.forEach(button => {
        button.addEventListener("click", function (event) {
            event.preventDefault();
            const boatCard = this.closest(".catalog-item");
            const boatImgSrc = boatCard.querySelector(".catalog-image img").src;
            const boatTitle = boatCard.querySelector("h3").textContent;

            boatImage.src = boatImgSrc;
            boatName.textContent = boatTitle;

            modal.classList.add("active");
            overlay.classList.add("active");
        });
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –æ–∫–Ω–∞
    closeModal.addEventListener("click", closeBooking);
    overlay.addEventListener("click", closeBooking);

    function closeBooking() {
        modal.classList.remove("active");
        overlay.classList.remove("active");
        submitBtn.textContent = "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É"; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
        submitBtn.classList.remove("loading"); // –£–±–∏—Ä–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
        submitBtn.removeAttribute("disabled"); // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É" —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–≥–ª–∞—Å–∏–∏ —Å –ø–æ–ª–∏—Ç–∏–∫–æ–π
    policyCheckbox.addEventListener("change", function () {
        if (this.checked) {
            submitBtn.classList.add("active");
            submitBtn.removeAttribute("disabled");
        } else {
            submitBtn.classList.remove("active");
            submitBtn.setAttribute("disabled", "true");
        }
    });

    // –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏ –≤ Telegram
    bookingForm.addEventListener("submit", function (event) {
        event.preventDefault();

        if (submitBtn.disabled) return; // –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ —É–∂–µ –Ω–∞–∂–∞—Ç–∞ ‚Äì –≤—ã—Ö–æ–¥–∏–º

        const userName = document.getElementById("name").value.trim();
        const userPhone = document.getElementById("phone").value.trim();
        const userComment = document.getElementById("comment").value.trim();
        const boatTitle = boatName.textContent;

        if (!userName || !userPhone) {
            alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω!");
            return;
        }

        // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –≤–æ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
        submitBtn.textContent = "–û—Ç–ø—Ä–∞–≤–∫–∞...";
        submitBtn.classList.add("loading");
        submitBtn.setAttribute("disabled", "true");

        // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
        const message = `
üö§ *–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ –∞—Ä–µ–Ω–¥—É!*
üõ•Ô∏è –Ø—Ö—Ç–∞: *${boatTitle}*
üë§ –ò–º—è: *${userName}*
üìû –¢–µ–ª–µ—Ñ–æ–Ω: *${userPhone}*
üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${userComment || "–ù–µ —É–∫–∞–∑–∞–Ω"}
        `;

        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram —á–µ—Ä–µ–∑ API
        fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                chat_id: TELEGRAM_CHAT_ID,
                text: message,
                parse_mode: "Markdown"
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.ok) {
                alert("‚úÖ –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!");
                bookingForm.reset();
                closeBooking();
            } else {
                alert("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.");
                submitBtn.textContent = "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É";
                submitBtn.classList.remove("loading");
                submitBtn.removeAttribute("disabled");
            }
        })
        .catch(error => {
            console.error("–û—à–∏–±–∫–∞:", error);
            alert("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.");
            submitBtn.textContent = "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É";
            submitBtn.classList.remove("loading");
            submitBtn.removeAttribute("disabled");
        });
    });
});


document.addEventListener("DOMContentLoaded", function () {
    const reviewContainer = document.querySelector(".reviews-container");
    
    let isDown = false;
    let startX;
    let scrollLeft;

    // –ù–∞—á–∞–ª–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
    reviewContainer.addEventListener("mousedown", (e) => {
        isDown = true;
        reviewContainer.classList.add("active");
        startX = e.pageX - reviewContainer.offsetLeft;
        scrollLeft = reviewContainer.scrollLeft;
    });

    // –ö–æ–Ω–µ—Ü –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è
    reviewContainer.addEventListener("mouseleave", () => {
        isDown = false;
        reviewContainer.classList.remove("active");
    });

    reviewContainer.addEventListener("mouseup", () => {
        isDown = false;
        reviewContainer.classList.remove("active");
        snapToNearest();
    });

    // –î–≤–∏–∂–µ–Ω–∏–µ –ø–æ –æ—Å–∏ X
    reviewContainer.addEventListener("mousemove", (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - reviewContainer.offsetLeft;
        const walk = (x - startX) * 2; // –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–∫—Ä—É—Ç–∫–∏
        reviewContainer.scrollLeft = scrollLeft - walk;
    });

    // –§—É–Ω–∫—Ü–∏—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ –æ—Ç–∑—ã–≤–∞
    function snapToNearest() {
        const reviewWidth = 340; // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ + –æ—Ç—Å—Ç—É–ø—ã
        const scrollPosition = reviewContainer.scrollLeft;
        const nearestReview = Math.round(scrollPosition / reviewWidth) * reviewWidth;
        
        reviewContainer.scrollTo({
            left: nearestReview,
            behavior: "smooth"
        });
    }
});

const images = ["yacht1.jpg", "yacht2.jpg", "yacht3.jpg"];
let currentIndex = 0;

function changeImage(img) {
    document.getElementById("main-yacht-img").src = img.src;
}

function prevImage() {
    currentIndex = (currentIndex - 1 + images.length) % images.length;
    document.getElementById("main-yacht-img").src = images[currentIndex];
}

function nextImage() {
    currentIndex = (currentIndex + 1) % images.length;
    document.getElementById("main-yacht-img").src = images[currentIndex];
}


document.addEventListener("DOMContentLoaded", function () {
    const mainImage = document.getElementById("mainImage");
    const thumbnails = document.querySelectorAll(".thumbnails img");
    const backArrow = document.getElementById("backArrow");

    // –ó–∞–ø–æ–º–∏–Ω–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
    const defaultImageSrc = mainImage.src;

    thumbnails.forEach((thumbnail) => {
        thumbnail.addEventListener("click", function () {
            mainImage.src = this.src;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–µ–ª–∫—É
            backArrow.classList.add("show");

            // –û–±–Ω–æ–≤–ª—è–µ–º active —É –º–∏–Ω–∏–∞—Ç—é—Ä
            thumbnails.forEach((thumb) => thumb.classList.remove("active"));
            this.classList.add("active");
        });
    });

    // –ö–ª–∏–∫ –ø–æ —Å—Ç—Ä–µ–ª–∫–µ ‚Äî –≤–µ—Ä–Ω—É—Ç—å –ø–µ—Ä–≤—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É
    backArrow.addEventListener("click", function () {
        mainImage.src = defaultImageSrc;

        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –º–∏–Ω–∏–∞—Ç—é—Ä—É
        thumbnails.forEach((thumb) => thumb.classList.remove("active"));
        thumbnails[0].classList.add("active");

        // –ü—Ä—è—á–µ–º —Å—Ç—Ä–µ–ª–∫—É
        backArrow.classList.remove("show");
    });
});


document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".catalog-item").forEach((item) => {
        try {
            const images = item.querySelectorAll(".catalog-photo");
            let currentIndex = 0;

            if (!images.length) {
                console.warn("‚ùå –û—à–∏–±–∫–∞: –Ω–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∫–∞—Ä—Ç–æ—á–∫–µ:", item);
                return;
            }

            function updateImage(index) {
                images.forEach((img, i) => {
                    img.classList.toggle("active", i === index);
                });
            }

            item.querySelector(".prev-btn").addEventListener("click", (event) => {
                event.stopPropagation();
                currentIndex = (currentIndex - 1 + images.length) % images.length;
                updateImage(currentIndex);
            });

            item.querySelector(".next-btn").addEventListener("click", (event) => {
                event.stopPropagation();
                currentIndex = (currentIndex + 1) % images.length;
                updateImage(currentIndex);
            });

            updateImage(currentIndex);
        } catch (error) {
            console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—Ä–µ–ª–∏—Å—Ç—ã–≤–∞–Ω–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:", error);
        }
    });
});

document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".catalog-item").forEach((item) => {
        const mainImage = item.querySelector(".catalog-photo");
        const prevBtn = item.querySelector(".prev-btn");
        const nextBtn = item.querySelector(".next-btn");
        const detailsBtn = item.querySelector(".btn-details");
        const rentBtn = item.querySelector(".btn-rent");

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —è—Ö—Ç—ã
        const yachtPages = {
            "HERMES": "HERMES.html",
            "ECLIPSE": "ECLIPSE.html",
            "–ö–∞—Ç–µ—Ä Velvette": "Velvette.html"
        };

        let yachtName = item.querySelector("h3").innerText.trim();
        let currentIndex = 0;

        const images = {
            "HERMES": ["yacht-hecmes.png", "yacht-hecmes1.png", "yacht-hecmes2.png", "yacht-hecmes3.png", "yacht-hecmes4.png", "yacht-hecmes5.png", "yacht-hecmes6.png", "yacht-hecmes7.png", "yacht-hecmes8.png", "yacht-hecmes9.png"],
            "ECLIPSE": ["ECLIPSE.png", "ECLIPSE1.png", "ECLIPSE3.png", "ECLIPSE4.png", "ECLIPSE5.png", "ECLIPSE6.png", "ECLIPSE7.png", "ECLIPSE8.png", "ECLIPSE9.png", "ECLIPSE10.png"],
            "–ö–∞—Ç–µ—Ä Velvette": ["VELVETTE1.png","VELVETTE2.png", "VELVETTE3.png", "VELVETTE4.png", "VELVETTE5.png", "VELVETTE6.png", "VELVETTE7.png"]
        };

        if (!images[yachtName] || images[yachtName].length === 0) return;

        function updateImage(index) {
            mainImage.src = images[yachtName][index];
        }

        prevBtn.addEventListener("click", (event) => {
            event.stopPropagation();
            currentIndex = (currentIndex - 1 + images[yachtName].length) % images[yachtName].length;
            updateImage(currentIndex);
        });

        nextBtn.addEventListener("click", (event) => {
            event.stopPropagation();
            currentIndex = (currentIndex + 1) % images[yachtName].length;
            updateImage(currentIndex);
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –≤—Å—é –∫–∞—Ä—Ç–æ—á–∫—É, –Ω–æ –∏—Å–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏
        item.addEventListener("click", (event) => {
            if (!event.target.closest(".btn-details") && !event.target.closest(".btn-rent") && !event.target.closest(".prev-btn") && !event.target.closest(".next-btn")) {
                window.location.href = yachtPages[yachtName] || "#"; // –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —è—Ö—Ç—ã
            }
        });

        updateImage(currentIndex);
    });

});



document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".catalog-item").forEach((item) => {
        const images = item.querySelectorAll(".catalog-photo");
        const prevBtn = item.querySelector(".prev-btn");
        const nextBtn = item.querySelector(".next-btn");

        let currentIndex = 0;

        function updateImage(index) {
            images.forEach((img, i) => {
                img.classList.toggle("active", i === index);
            });
        }

        prevBtn.addEventListener("click", (event) => {
            event.stopPropagation();
            currentIndex = (currentIndex - 1 + images.length) % images.length;
            updateImage(currentIndex);
        });

        nextBtn.addEventListener("click", (event) => {
            event.stopPropagation();
            currentIndex = (currentIndex + 1) % images.length;
            updateImage(currentIndex);
        });

        updateImage(currentIndex);
    });
});


document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".catalog-item").forEach((item) => {
        const images = item.querySelectorAll(".catalog-photo");
        const prevBtn = item.querySelector(".prev-btn");
        const nextBtn = item.querySelector(".next-btn");
        const detailsBtn = item.querySelector(".btn-details");
        const rentBtn = item.querySelector(".btn-rent");

        let currentIndex = 0;

        function updateImage(index) {
            images.forEach((img, i) => img.classList.toggle("active", i === index));
        }

        prevBtn.addEventListener("click", (event) => {
            event.stopPropagation();
            currentIndex = (currentIndex - 1 + images.length) % images.length;
            updateImage(currentIndex);
        });

        nextBtn.addEventListener("click", (event) => {
            event.stopPropagation();
            currentIndex = (currentIndex + 1) % images.length;
            updateImage(currentIndex);
        });

        // –ö–ª–∏–∫ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–µ (–ø–µ—Ä–µ–±—Ä–æ—Å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É)
        item.addEventListener("click", (event) => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –∫–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ (—á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞—Ç—å —Ä–∞–±–æ—Ç–µ –∫–Ω–æ–ø–æ–∫)
            if (!event.target.closest(".prev-btn") && 
                !event.target.closest(".next-btn") && 
                !event.target.closest(".btn-details") && 
                !event.target.closest(".btn-rent")) {
                    
                // –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ —è—Ö—Ç—ã –∏–∑ data-yacht –∞—Ç—Ä–∏–±—É—Ç–∞ –∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞
                let yachtPage = detailsBtn?.getAttribute("href") || "#";
                window.location.href = yachtPage;
            }
        });

        updateImage(currentIndex);
    });
});

document.addEventListener("DOMContentLoaded", function() {
    const images = document.querySelectorAll(".lazyload");

    const observer = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const img = entry.target;
                img.src = img.dataset.src;
                img.classList.remove("lazyload");
                observer.unobserve(img);
            }
        });
    });

    images.forEach(img => observer.observe(img));
});